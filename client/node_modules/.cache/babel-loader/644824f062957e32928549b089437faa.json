{"ast":null,"code":"var _jsxFileName = \"/Users/Angelota/Library/Mobile Documents/com~apple~CloudDocs/Desktop/UCM/TFG INFOR/github/aux/TFG-Plataforma-blockchain-para-visualizar-la-reputacion-de-empresas-sobre-casos-de-discriminacion/client/src/Components/Form/form.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { context } from './../../contextProvider.js';\nimport Web3 from 'web3';\nimport * as constants from './../../constantFile.js';\nimport complaintContract from './../../complaintContract.json';\nimport { useForm } from 'react-hook-form';\nimport * as data from './constantData';\nimport swal from 'sweetalert';\nimport Swal from 'sweetalert2'; //Si todavia no se ha conectado con Metamask entonces aparece un popup para la conexion\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst infuraUrl = constants.INFURA_URL; //Crea una instancia para comunicarse con el nodo indicado\n\nconst web3 = new Web3(new Web3.providers.HttpProvider(infuraUrl)); //Nos conectamos con el contrato\n\nconst contract = new web3.eth.Contract(complaintContract.abi, constants.CONTRACT_ADDRESS);\nlet companies = [\"\"];\ncontract.methods.getCompanies().call().then(response => companies = response);\n\nconst Complaint = _ref => {\n  _s();\n\n  let {\n    match\n  } = _ref;\n  const company = match.params.id;\n  const {\n    handleSubmit,\n    register,\n    formState: {\n      errors,\n      isSubmitting,\n      isSubmitSuccessful\n    }\n  } = useForm();\n  const Context = React.useContext(context); //Obtener la fecha actual\n\n  function formatoFecha(fecha, formato) {\n    const map = {\n      dd: fecha.getDate(),\n      mm: fecha.getMonth() + 1,\n      yy: fecha.getFullYear().toString().slice(-2),\n      yyyy: fecha.getFullYear()\n    };\n    return formato.replace(/dd|mm|yy|yyy/gi, matched => map[matched]);\n  } //Función para realizar la transaccion al recibir los parametros\n\n\n  async function newComplaint(transaction) {\n    try {\n      const tx = {\n        to: constants.CONTRACT_ADDRESS,\n        //Dirección del contrato\n        data: transaction.encodeABI(),\n        //\n        gas: await transaction.estimateGas({\n          from: constants.ADDRESS2\n        }),\n        //Se estima el coste en gas\n        gasPrice: await Context.web3.eth.getGasPrice(),\n        //Precio del gas\n        gaslimit: 0x1000000,\n        //Limite de gas que se puede gastar\n        value: 0 //No se va a realizar una transferencia\n\n      };\n      console.log(\"transacción construida\"); //Se firma la transacción con la clave privada\n\n      const signedTx = await Context.web3.eth.accounts.signTransaction(tx, constants.PRIVATE_KEY2);\n      console.log(\"transacción firmada\"); //Se envia la transaccion firmada \n\n      await Context.web3.eth.sendSignedTransaction(signedTx.rawTransaction);\n    } catch (err) {\n      console.log(err.message);\n      swal({\n        title: \"ERROR\",\n        text: \"Algo ha ido mal a la hora de subir la denuncia a la blockchain. Vuelva a intentarlo más tarde\",\n        icon: \"error\",\n        button: \"Aceptar\"\n      });\n    }\n  }\n\n  const submitForm = async (data, e) => {\n    e.preventDefault(); //Comprobar que el usuario esta conectado a linkedin\n\n    if (!Context.user) {\n      console.log(\"El usuario no está conectado\");\n      swal({\n        title: \"ERROR\",\n        text: \"¡Debes estar conectado para enivar una denuncia!\",\n        icon: \"error\",\n        button: \"Aceptar\"\n      });\n    } else {\n      //Obtener fecha\n      const fecha = new Date();\n      fecha.toLocaleDateString();\n      const date = formatoFecha(fecha, 'dd/mm/yy');\n      Swal.fire({\n        title: 'La denuncia está siendo cargada en la blockchain',\n        timer: 1000000,\n        timerProgressBar: false,\n        didOpen: () => {\n          Swal.showLoading();\n        }\n      }); //Relizar la denuncia\n\n      await newComplaint(Context.contract.methods.newComplaint(data.company, Context.user, data.text, date, data.type, data.gender, data.relation, data.consent)); //Restaurar estado del formulario\n\n      e.target.reset(); //Si salimos del formulario puede que no haga falta este reset\n      //Volver a la pagina de la empresa\n\n      Swal.fire({\n        title: \"Denuncia cargada\",\n        text: \"La denuncia ya ha sido registrada en la blockchain\",\n        icon: \"success\",\n        timer: \"10000\"\n      }).then(function () {\n        window.location.href = `http://localhost:3000/company/${company}`;\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"ui form\",\n    onSubmit: handleSubmit(submitForm),\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"ui dividing header\",\n      children: \"Formulario de Denuncia\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"two fields\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"required field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Nombre de la empresa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"ui fluid selection dropdown\",\n            ...register(\"company\", {\n              validate: value => value !== \"Seleccione la empresa\"\n            }),\n            children: companies.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: item,\n              selected: item == company,\n              children: item\n            }, item, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 40\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this), errors.company && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ui negative message\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"header\",\n              children: \"Debe seleccionar la empresa\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 23\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 32\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Relaci\\xF3n actual con la empresa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"ui fluid selection dropdown\",\n            ...register(\"relation\"),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              hidden: true,\n              children: \"Seleccione la relaci\\xF3n actual con la empresa\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 17\n            }, this), data.relations.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: item,\n              children: item\n            }, item, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 45\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"three fields\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inline fields\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\xBFHas denunciado anteriormente?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ui radio checkbox\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register(\"moreComplaints\"),\n              value: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"S\\xED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ui radio checkbox\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register(\"moreComplaints\"),\n              value: false\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"No\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Medio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          ...register(\"media\"),\n          placeholder: \"En caso afirmativo, \\xBFmediante qu\\xE9 medio?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Fecha aproximada del suceso o del inicio de este\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"two fields\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field\",\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"ui fluid search dropdown\",\n              ...register(\"month\"),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                hidden: true,\n                children: \"Seleccione el mes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 17\n              }, this), data.months.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item,\n                children: item\n              }, item, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 42\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"field\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              ...register('year', {\n                valueAsNumber: true,\n                maxLength: 4,\n                minLength: 4\n              }),\n              placeholder: \"A\\xF1o\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 13\n            }, this), errors.year && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ui negative message\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"header\",\n                children: \" Debe escribir correctamente el a\\xF1o\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"required field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Tipo de denuncia\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"ui fluid dropdown\",\n          ...register('type', {\n            validate: value => value !== \"Seleccione el tipo de denuncia\"\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            hidden: true,\n            children: \"Seleccione el tipo de denuncia\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this), data.complaintTypes.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: item,\n            children: item\n          }, item, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 46\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 7\n      }, this), errors.type && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ui negative message\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header\",\n          children: \"Debe seleccionar el tipo de denuncia\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 23\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"five fields\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Si tu denuncia es de g\\xE9nero\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"ui fluid selection dropdown\",\n          ...register(\"gender\"),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            hidden: true,\n            children: \"G\\xE9nero\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 17\n          }, this), data.genders.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: item,\n            children: item\n          }, item, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 43\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Si tu denuncia es de discapacidad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          ...register(\"discapacidad\"),\n          placeholder: \"Discapacidad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Si tu denuncia es de etnia\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"ui dropdown\",\n          ...register(\"country\"),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            hidden: true,\n            children: \"Seleccione pa\\xEDs de origen\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 11\n          }, this), data.countries.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: item,\n            children: item\n          }, item, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 39\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Si tu denuncia es de edad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          ...register('age', {\n            valueAsNumber: true,\n            maxLength: 3\n          }),\n          placeholder: \"Edad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 9\n        }, this), errors.age && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ui negative message\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header\",\n            children: \" Debe escribir correctamente su edad\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 23\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 24\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Si tu denuncia es de religi\\xF3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          ...register(\"religion\"),\n          placeholder: \"Religi\\xF3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"required field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Descripci\\xF3n del suceso\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", { ...register('text', {\n          required: true\n        }),\n        placeholder: \"Cu\\xE9ntanos tu historia\",\n        style: {\n          minHeight: 50\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this), errors.text && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ui negative message\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header\",\n          children: \"Debe describir el suceso\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ui segment\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ui checkbox\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register(\"consent\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Acepto que mi historia aparezca publicada de forma an\\xF3nima\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"ui button\",\n      type: \"submit\",\n      children: \"Enviar denuncia\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Complaint, \"1L3DbcpsHx3FG95LN+agexEYlws=\", false, function () {\n  return [useForm];\n});\n\n_c = Complaint;\nexport default Complaint;\n\nvar _c;\n\n$RefreshReg$(_c, \"Complaint\");","map":{"version":3,"sources":["/Users/Angelota/Library/Mobile Documents/com~apple~CloudDocs/Desktop/UCM/TFG INFOR/github/aux/TFG-Plataforma-blockchain-para-visualizar-la-reputacion-de-empresas-sobre-casos-de-discriminacion/client/src/Components/Form/form.js"],"names":["React","useState","context","Web3","constants","complaintContract","useForm","data","swal","Swal","infuraUrl","INFURA_URL","web3","providers","HttpProvider","contract","eth","Contract","abi","CONTRACT_ADDRESS","companies","methods","getCompanies","call","then","response","Complaint","match","company","params","id","handleSubmit","register","formState","errors","isSubmitting","isSubmitSuccessful","Context","useContext","formatoFecha","fecha","formato","map","dd","getDate","mm","getMonth","yy","getFullYear","toString","slice","yyyy","replace","matched","newComplaint","transaction","tx","to","encodeABI","gas","estimateGas","from","ADDRESS2","gasPrice","getGasPrice","gaslimit","value","console","log","signedTx","accounts","signTransaction","PRIVATE_KEY2","sendSignedTransaction","rawTransaction","err","message","title","text","icon","button","submitForm","e","preventDefault","user","Date","toLocaleDateString","date","fire","timer","timerProgressBar","didOpen","showLoading","type","gender","relation","consent","target","reset","window","location","href","validate","item","relations","months","valueAsNumber","maxLength","minLength","year","complaintTypes","genders","countries","age","required","minHeight"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { context } from './../../contextProvider.js';\nimport Web3 from 'web3';\nimport * as constants from './../../constantFile.js';\nimport complaintContract from './../../complaintContract.json';\nimport { useForm } from 'react-hook-form';\nimport * as data from './constantData';\nimport swal from 'sweetalert';\nimport Swal from 'sweetalert2';\n\n\n//Si todavia no se ha conectado con Metamask entonces aparece un popup para la conexion\nconst infuraUrl = constants.INFURA_URL;\n//Crea una instancia para comunicarse con el nodo indicado\nconst web3 = new Web3(new Web3.providers.HttpProvider(infuraUrl));\n//Nos conectamos con el contrato\nconst contract = new web3.eth.Contract(complaintContract.abi, constants.CONTRACT_ADDRESS);\nlet companies = [\"\"];\ncontract.methods.getCompanies().call().then(response => companies = response);\n\n\nconst Complaint = ({ match }) => {\n\n  const company = match.params.id;\n  const { handleSubmit, register, formState: { errors, isSubmitting, isSubmitSuccessful }} = useForm(/*{ shouldUnregister : true}*/);\n  \n  const Context = React.useContext(context);\n  \n\n  //Obtener la fecha actual\n  function formatoFecha(fecha, formato) {\n    const map = {\n        dd: fecha.getDate(),\n        mm: fecha.getMonth() + 1,\n        yy: fecha.getFullYear().toString().slice(-2),\n        yyyy: fecha.getFullYear()\n    }\n    return formato.replace(/dd|mm|yy|yyy/gi, matched => map[matched])\n  }\n\n  //Función para realizar la transaccion al recibir los parametros\n  async function newComplaint(transaction) {\n    try {\n        const tx = {\n            to      : constants.CONTRACT_ADDRESS, //Dirección del contrato\n            data    : transaction.encodeABI(),      //\n            gas     : await transaction.estimateGas({from: constants.ADDRESS2}),   //Se estima el coste en gas\n            gasPrice: await Context.web3.eth.getGasPrice(),   //Precio del gas\n            gaslimit: 0x1000000,   //Limite de gas que se puede gastar\n            value   : 0,   //No se va a realizar una transferencia\n        };\n        console.log(\"transacción construida\");\n        //Se firma la transacción con la clave privada\n        const signedTx  = await Context.web3.eth.accounts.signTransaction(tx, constants.PRIVATE_KEY2);\n        console.log(\"transacción firmada\");\n        //Se envia la transaccion firmada \n        await Context.web3.eth.sendSignedTransaction(signedTx.rawTransaction);\n    }\n    catch (err) {\n        console.log(err.message);\n        swal({\n          title: \"ERROR\",\n          text: \"Algo ha ido mal a la hora de subir la denuncia a la blockchain. Vuelva a intentarlo más tarde\",\n          icon: \"error\",\n          button: \"Aceptar\"\n        });\n    }\n  }\n\n\n  const submitForm = async (data,e) => {\n    e.preventDefault();\n\n    //Comprobar que el usuario esta conectado a linkedin\n    if(!Context.user){\n      console.log(\"El usuario no está conectado\");\n      swal({\n        title: \"ERROR\",\n        text: \"¡Debes estar conectado para enivar una denuncia!\",\n        icon: \"error\",\n        button: \"Aceptar\"\n      });\n    }\n    else{\n      //Obtener fecha\n      const fecha = new Date();\n      fecha.toLocaleDateString();\n      const date = formatoFecha(fecha, 'dd/mm/yy');\n\n      Swal.fire({\n        title: 'La denuncia está siendo cargada en la blockchain',\n        timer: 1000000,\n        timerProgressBar: false,\n        didOpen: () => {\n          Swal.showLoading()\n        }\n      });\n\n      //Relizar la denuncia\n      await newComplaint(Context.contract.methods.newComplaint(data.company, Context.user, data.text, date, data.type, data.gender, data.relation, data.consent));\n\n      //Restaurar estado del formulario\n      e.target.reset(); //Si salimos del formulario puede que no haga falta este reset\n\n      //Volver a la pagina de la empresa\n      Swal.fire({\n        title: \"Denuncia cargada\",\n        text: \"La denuncia ya ha sido registrada en la blockchain\",\n        icon: \"success\",\n        timer: \"10000\"\n      }).then(function () {\n        window.location.href = `http://localhost:3000/company/${company}`;\n      });  \n    }\n  }\n\n\n  return(\n\n    <form className=\"ui form\" onSubmit = {handleSubmit(submitForm)}>\n      <h1 className=\"ui dividing header\">Formulario de Denuncia</h1>\n      <div className=\"field\">\n        <div className=\"two fields\">\n\n          {/*Nombre empresa*/}\n          <div className=\"required field\">\n            <label>Nombre de la empresa</label>\n            <select\n              className=\"ui fluid selection dropdown\"\n              {...register(\"company\", {\n                validate : value => value !== \"Seleccione la empresa\"\n              })}>\n                {companies.map(item => <option value={item} key={item} selected = {item == company}>{item}</option>)}\n            </select>\n            {errors.company && <div className = \"ui negative message\">\n                      <div className = \"header\">Debe seleccionar la empresa</div></div>}\n          </div>\n          \n          \n          {/*Relación con empresa*/}\n          <div className=\"field\">\n            <label>Relación actual con la empresa</label>\n            <select \n              className=\"ui fluid selection dropdown\" \n              {...register(\"relation\")}>\n                <option hidden>Seleccione la relación actual con la empresa</option>\n                {data.relations.map(item => <option value={item} key={item}>{item}</option>)}\n            </select>\n          </div>\n        </div>\n      </div>\n\n\n      <div className=\"three fields\">\n\n        {/*Denunciado antes*/}\n        <div className=\"inline fields\">\n          <label>¿Has denunciado anteriormente?</label>\n          <div className=\"field\">\n            <div className=\"ui radio checkbox\">\n              <input \n                type=\"radio\"\n                {...register(\"moreComplaints\")}\n                value = {true}/>\n              <label>Sí</label>\n            </div>\n          </div>\n\n          <div className=\"field\">\n            <div className=\"ui radio checkbox\">\n              <input \n                type=\"radio\"\n                {...register(\"moreComplaints\")}\n                value = {false}/>\n              <label>No</label>\n            </div>\n          </div>\n        </div>\n\n        {/*Mediante que medio denunciaste*/}\n        <div className=\"field\">\n          <label>Medio</label>\n          <input \n            type=\"text\"\n            {...register(\"media\")} \n            placeholder=\"En caso afirmativo, ¿mediante qué medio?\"/>\n        </div>\n\n        {/*Fecha del suceso*/}\n        <div className=\"field\">\n        <label>Fecha aproximada del suceso o del inicio de este</label>\n        <div className=\"two fields\">\n          <div className=\"field\">\n            <select \n              className=\"ui fluid search dropdown\" \n              {...register(\"month\")} >\n                <option hidden>Seleccione el mes</option>\n                {data.months.map(item => <option value={item} key={item}>{item}</option>)}\n            </select>\n          </div>\n\n          <div className=\"field\">\n            <input \n              type=\"text\"\n              {... register('year', {\n                valueAsNumber : true,\n                maxLength : 4,\n                minLength : 4\n              })}  \n              placeholder=\"Año\"/>\n            {errors.year && <div className = \"ui negative message\">\n                      <div className = \"header\"> Debe escribir correctamente el año</div></div>}\n          </div>\n        </div>\n        </div>\n      </div>\n        \n    <div className=\"field\">      \n      {/*Tipo de denuncia*/}\n      <div className=\"required field\">\n        <label>Tipo de denuncia</label>\n        <select \n          className=\"ui fluid dropdown\"\n          {...register('type', {\n            validate : value => value !== \"Seleccione el tipo de denuncia\"\n          })}>\n            <option hidden>Seleccione el tipo de denuncia</option>\n            {data.complaintTypes.map(item => <option value={item} key={item}>{item}</option>)}\n        </select>\n      </div>\n      {errors.type && <div className = \"ui negative message\">\n                      <div className = \"header\">Debe seleccionar el tipo de denuncia</div></div>}\n    </div>\n    \n\n\n    {/*El usuario deberá solo responder obligatoriamente a aquella relacionada con su tipo de denuncia. El resto son opcionales*/}\n    <div className=\"five fields\">\n\n      {/*Género*/}\n      <div className=\"field\">\n          <label>Si tu denuncia es de género</label>\n          <select \n              className=\"ui fluid selection dropdown\" \n              {...register(\"gender\")}>\n                <option hidden>Género</option>\n                {data.genders.map(item => <option value={item} key={item}>{item}</option>)}\n            </select>\n      </div>\n\n      {/*Discapacidad*/}\n      <div className=\"field\">\n          <label>Si tu denuncia es de discapacidad</label>\n          <input \n            type=\"text\"\n            {...register(\"discapacidad\")}\n            placeholder=\"Discapacidad\"/>\n      </div>\n\n      {/*País*/}\n      <div className=\"field\">\n      <label>Si tu denuncia es de etnia</label>\n        <select \n          className=\"ui dropdown\"\n          {...register(\"country\")} >\n          <option hidden>Seleccione país de origen</option>\n          {data.countries.map(item => <option value={item} key={item}>{item}</option>)}\n        </select>\n      </div>\n\n      {/*Edad*/}\n      <div className=\"field\">\n        <label>Si tu denuncia es de edad</label>\n        <input \n          type=\"text\"\n          {... register('age', {\n            valueAsNumber : true,\n            maxLength : 3\n          })} \n          placeholder=\"Edad\"/>\n        {errors.age && <div className = \"ui negative message\">\n                      <div className = \"header\"> Debe escribir correctamente su edad</div></div>}\n      </div>\n\n      {/*Religión*/}\n      <div className=\"field\">\n        <label>Si tu denuncia es de religión</label>\n        <input \n          type=\"text\"\n          {...register(\"religion\")} \n          placeholder=\"Religión\"/>\n      </div>\n    </div>    \n\n    {/*El usuario contará su historia*/} \n    <div className=\"required field\">\n    <label >Descripción del suceso</label>\n        <textarea  \n          {...register('text', {\n            required : true,\n          })}\n          placeholder=\"Cuéntanos tu historia\"\n          style={{ minHeight: 50 }}/>\n    {errors.text && <div className = \"ui negative message\">\n                      <div className = \"header\">Debe describir el suceso</div></div>}\n    </div>\n\n      {/*Botón para permitir compartir la historia. No es obligatorio para el usuario*/}\n      <div className=\"ui segment\">\n        <div className=\"field\">\n          <div className=\"ui checkbox\">\n            <input \n              type=\"checkbox\"\n              {...register(\"consent\")}/>\n            <label>Acepto que mi historia aparezca publicada de forma anónima</label>\n          </div>\n        </div>\n      </div>\n      <button className = \"ui button\" type = \"submit\">Enviar denuncia</button>\n    </form>\n  );\n};\nexport default Complaint;"]},"metadata":{},"sourceType":"module"}